#=============================================================================
#
# file :        Makefile.h
#
# description : Include for the Multiplexer class.
#
# project :     Makefile to generate a Tango server
#
# $Author$
#
# $Revision$
#
# $Log$
# Revision 1.2  2007/09/03 11:01:51  rsune
# Added support for terminated modes
# Added a mutex to the static members
# TODO: Now only one multiplexer (with up to two tango devices) can be used with one server
#
# Revision 1.1.1.1  2007/08/31 14:15:24  rsune
# Minor changes over original Soleil device
#
# Revision 1.1.1.1  2004/11/08 14:14:19  root
# initial import
#
#
# copyleft :    European Synchrotron Radiation Facility
#               BP 220, Grenoble 38043
#               FRANCE
#
#=============================================================================
#  		This file is generated by POGO
#	(Program Obviously used to Generate tango Object)
#
#         (c) - Software Engineering Group - ESRF
#=============================================================================
#

CLASS =	Multiplexer
RELEASE    = Release_$(MAJOR_VERS)_$(MINOR_VERS)

ifdef no_debug
	DEBUG = -O2
else
	DEBUG = -g -DDEBUG_ADLINK_DEVICE
endif


ifdef _solaris
CC = CC $(DEBUG)
BIN_DIR = solaris7_CC
endif

ifdef linux
CC = c++ $(DEBUG)
AR = ar
BIN_DIR = suse102
endif

#NI_HOME      =  /usr/local
NI_HOME      =  $(SICILIA)
TANGO_HOME   =  $(SICILIA)
OMNI_HOME    =  $(SICILIA)
INCLUDE_DIRS =  -I$(TANGO_HOME)/include	-I. -I$(OMNI_HOME)/include -I$(NI_HOME)/include
LIB_DIRS     =  -L $(TANGO_HOME)/lib -L $(OMNI_HOME)/lib -L $(NI_HOME)/lib -L $(SICILIA)/lib/cpp

ifdef _solaris
CXXFLAGS =  -mt -D_PTHREADS $(INCLUDE_DIRS)
LFLAGS =  $(LIB_DIRS)  		\
				-ltango			\
				-llog4tango		\
				-lomniORB4 		\
				-lomniDynamic4	\
				-lomnithread	\
				-lCOS4 \
				-lpthread		\
				-lposix4 -lsocket -lnsl
endif

ifdef linux
CXXFLAGS =  -D_REENTRANT $(INCLUDE_DIRS)
LFLAGS =  $(LIB_DIRS)  		\
				-ltango			\
				-llog4tango		\
				-lomniORB4 		\
				-lomniDynamic4	\
				-lomnithread	\
				-lCOS4 \
				-ldl -lpthread \
				-lnidaqmx
endif






SVC_OBJS = 	main.o	\
		ClassFactory.o	\
		$(CLASS)Class.o	\
		NiSwitchSupport.o \
		$(CLASS)StateMachine.o \
		$(CLASS).o

SVC_INC = 	$(CLASS)Class.h \
			$(CLASS).h


%.o: %.cpp $(SVC_INC)
	$(CC) $(CXXFLAGS) -c $<
			
all: MultiplexerNI

MultiplexerNI:	$(SVC_OBJS)
	$(CC) $(SVC_OBJS) -o MultiplexerNI $(LFLAGS)

clean:
	rm -f *.o $(CLASS) core *~
	
install:
	cp $(CLASS) $(TANGO_HOME)/bin/$(BIN_DIR)

#----------------------------------------------------
#	Tag the CVS module corresponding to this class
#----------------------------------------------------
tag:
	@cvstag "$(CLASS)-$(RELEASE)"
	@make   $(CLASS)
	@make show_tag

show_tag:
	@cvstag -d 
